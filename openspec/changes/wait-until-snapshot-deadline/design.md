# 設計メモ: snapshot-after の待機終了条件

## 目的

- `snapshot-after` が指定された場合、出力が早期に出たとしても
  ジョブが継続中であれば期限まで待機する。

## 方針

- 待機ループの終了条件は「ジョブが終了した」または「期限到達」に限定する。
- stdout/stderr のサイズ増加を理由とした早期終了は行わない。

## テスト方針

- `printf` で即時に出力しつつ `sleep` で継続するコマンドを使い、
  `waited_ms` が `snapshot-after` 以上になることを確認する。
- 長時間待機のテストは避け、`snapshot-after=200ms` で検証する。
