# 変更提案: snapshot-after は出力に依存せず期限まで待機

## 背景

`run` の待機が stdout/stderr の出力を検知すると早期終了するため、
`snapshot-after` を指定しても継続実行中のプロセスでは待機が短縮される。

## Why

- `snapshot-after` の意味を「期限まで待つ」に統一し、期待どおりの待機時間を保証する。

## 目的

- `snapshot-after` 指定時は、ジョブが継続中であれば期限まで待機する。
- 早期終了は「ジョブ終了」のみ許容する。

## スコープ

- `run` の待機ロジックの終了条件
- 仕様とテストの更新

## 非スコープ

- `snapshot-after` の上限や既定値の変更
- `tail` の挙動変更

## 仕様変更の要約

- 出力が存在しても、ジョブが `running` なら `snapshot-after` まで待機する。
- ジョブが終了した場合は期限より前に返却してよい。

## 検証方針

- 即時出力 + 継続実行のコマンドで `waited_ms >= snapshot-after` を確認する。
